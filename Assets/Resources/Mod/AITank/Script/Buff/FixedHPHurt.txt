local BaseBuff = require 'Mod.AITank.Script.Base.BaseBuff'
local buff = require 'Mod.AITank.Script.Base.Tank.Buff'
local fixedHPHurt = Class("FixedHPHurt", BaseBuff)

function fixedHPHurt:ctor(attributes)
	BaseBuff.ctor(self, attributes)
	self.count = 0
end

function fixedHPHurt:onAdd(source)
	-- 处理播放音效，播放动画等效果
end

function fixedHPHurt:onRemove(source)
	-- 同上
end

function fixedHPHurt:update(source, target)
	-- 只能有效一次
	if self.count >= 2 then
		return
	end
	-- 没有加血功能
	if source.gameObject == target.gameObject then
		return
	end
	
	if self.effects["FixedHP"] > 0 then
		self.effects["FixedHP"] = self.effects["FixedHP"] * -1
	end
	
	-- 处理数值计算
	BaseBuff.update(self, source, target)

	self.count = self.count + 1
end

-- TODO: 
buff:register("FixedHPHurt", fixedHPHurt)

