local buff = Class("Buff")

local all = {}

function buff:ctor(parent)
	self.parent = parent
	self.hurtCollision = parent.hurtCollision
	self.collision = self.hurtCollision.collision
	self.buffs = {}
	self.all = {}
end

function buff:register(name, buff)
	all[name] = buff
end

function buff:update()
	for _,v in pairs(self.collision) do
		for i = 1, #(self.buffs) do
			local tmp = self.buffs[i]
			tmp:update(self.parent, v)
		end
	end
end

function buff:add(name, effects)
	if not all[name] then
		print("buff:add() " .. name)
		return
	end

	table.insert(self.buffs, all[name].new(effects))
end

function buff:remove(buff)
	local j = 0
	for i = 1,#(self.buffs) do
		local tmp = self.buffs[i]
		if tmp == buff then
			j = i 
			break
		end
	end

	if j <= 0 then
		return
	end

	table.remove(self.buffs, j)
end

return buff